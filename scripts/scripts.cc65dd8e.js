var countTo=angular.module("countTo",[]).directive("countTo",["$timeout",function(a){return{replace:!1,scope:!0,link:function(b,c,d){var e,f,g,h,i,j,k,l=c[0],m=function(){f=30,i=0,b.timoutId=null,j=parseInt(d.countTo)||0,b.value=parseInt(d.value,10)||0,g=1e3*parseFloat(d.duration)||0,h=Math.ceil(g/f),k=(j-b.value)/h,e=b.value},n=function(){b.timoutId=a(function(){e+=k,i++,i>=h?(a.cancel(b.timoutId),e=j,l.innerText=j):(l.innerText=Math.round(e),n())},f)},o=function(){b.timoutId&&a.cancel(b.timoutId),m(),n()};return d.$observe("countTo",function(a){a&&o()}),d.$observe("value",function(){o()}),!0}}}]);angular.module("githubArenaApp",["ngAnimate","ngResource","ngRoute","ngTouch","ui.bootstrap","countTo"]).value("_",window._).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html"}).when("/contact",{templateUrl:"views/contact.html"}).otherwise({redirectTo:"/"})}]),angular.module("githubArenaApp").controller("MainCtrl",["$scope","$q","$timeout","Github","_",function(a,b,c,d,e){a.players=[],a.ready=!1,a.roundsDone=!1,a.master={},a.rounds=[],a.countDelay=1;var f=1e3,g=1500,h=0,i=[{title:"Repos",score:function(a){return a.userData.length}},{title:"Repos stars",score:function(a){var b=e.map(a.userData,function(a){return a.stargazers_count}),c=e.reduce(b,function(a,b){return a+b});return c}},{title:"Forks",score:function(a){var b=e.map(a.userData,function(a){return a.forks_count}),b=e.reduce(b,function(a,b){return a+b});return b}},{title:"Gists",score:function(a){return a.repoData.public_gists}},{title:"Followers",score:function(a){return a.repoData.followers}}];a.players[0]={name:"seriema",total:0},a.players[1]={name:"odetocode",total:0},a.reset=function(){a.ready=!1,a.roundsDone=!1,a.master={},a.rounds=[],h=0,angular.forEach(a.players,function(a){a.total=0,a.userData={},a.repoData={}})},a.fight=function(){var c=[];a.roundsDone=!1,angular.forEach(a.players,function(a){c.push(d.repo(a.name).then(function(b){a.userData=b.data})),c.push(d.user(a.name).then(function(b){a.repoData=b.data}))}),b.all(c).then(function(){angular.forEach(a.players,function(){}),a.ready=!0,a.nextRound()})},a.nextRound=function(){if(h===i.length){a.roundsDone=!0;var b=a.players[0].total>a.players[1].total?0:1;return void(a.master.name=a.players[b].name)}var d={};angular.copy(i[h],d),a.rounds.push(d),function(b){c(function(){var c=i[b].score(a.players[0])>i[b].score(a.players[1])?0:1;a.rounds[b].winner=a.players[c],a.players[c].total+=1},f)}(h),h++,a.wait()},a.wait=function(){c(function(){a.nextRound()},g)}}]),angular.module("githubArenaApp").service("Github",["$http","$q",function(a,b){function c(a){var c=b.defer();return c.resolve({data:a}),c.promise}function d(b){var d=f[b];return d?c(d):a.get(b).success(function(a){f[b]=a,window.localStorage.setItem("cache",JSON.stringify(f))})}var e="https://api.github.com/users/",f={},g=window.localStorage.getItem("cache");g&&(f=JSON.parse(g)),this.repo=function(a){return d(e+a+"/repos")},this.user=function(a){return d(e+a)}}]);