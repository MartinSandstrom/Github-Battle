var countTo=angular.module("countTo",[]).directive("countTo",["$timeout",function(a){return{replace:!1,scope:!0,link:function(b,c,d){var e,f,g,h,i,j,k,l=c[0],m=function(){f=30,i=0,b.timoutId=null,j=parseInt(d.countTo)||0,b.value=parseInt(d.value,10)||0,g=1e3*parseFloat(d.duration)||0,h=Math.ceil(g/f),k=(j-b.value)/h,e=b.value},n=function(){b.timoutId=a(function(){e+=k,i++,i>=h?(a.cancel(b.timoutId),e=j,l.innerText=j):(l.innerText=Math.round(e),n())},f)},o=function(){b.timoutId&&a.cancel(b.timoutId),m(),n()};return d.$observe("countTo",function(a){a&&o()}),d.$observe("value",function(){o()}),!0}}}]);angular.module("githubArenaApp",["ngAnimate","ngResource","ngRoute","ngTouch","ui.bootstrap","countTo"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html"}).when("/contact",{templateUrl:"views/contact.html"}).otherwise({redirectTo:"/"})}]),angular.module("githubArenaApp").controller("MainCtrl",["$scope","$q","$timeout","Github",function(a,b,c,d){a.players=[],a.ready=!1,a.roundsDone=!1,a.master={},a.rounds=[],a.countDelay=1;var e=1400,f=1500,g=0,h=[{title:"Repos",score:function(a){return a.userData.length}},{title:"Repos stars",score:function(a){var b=_.map(a.userData,function(a){return a.stargazers_count}),c=_.reduce(b,function(a,b){return a+b});return c}},{title:"Forks",score:function(a){var b=_.map(a.userData,function(a){return a.forks_count}),b=_.reduce(b,function(a,b){return a+b});return b}},{title:"Gists",score:function(a){return a.repoData.public_gists}},{title:"Followers",score:function(a){return a.repoData.followers}}];a.winner={repos:-1,repoStars:-1,forks:-1,gists:-1,userFollowers:-1},a.players[0]={name:"seriema",total:0},a.players[1]={name:"odetocode",total:0},a.reset=function(){a.ready=!1,a.roundsDone=!1,a.master={},a.rounds=[],g=0,angular.forEach(a.players,function(a){a.total=0,a.userData={},a.repoData={}})},a.fight=function(){var c=[];a.roundsDone=!1,angular.forEach(a.players,function(a){c.push(d.repo(a.name).then(function(b){a.userData=b.data})),c.push(d.user(a.name).then(function(b){a.repoData=b.data}))}),b.all(c).then(function(){angular.forEach(a.players,function(){}),a.ready=!0,a.nextRound()})},a.nextRound=function(){if(g===h.length){a.roundsDone=!0;var b=a.players[0].total>a.players[1].total?0:1;return void(a.master.name=a.players[b].name)}var d={};angular.copy(h[g],d),a.rounds.push(d),function(b){c(function(){var c=h[b].score(a.players[0])>h[b].score(a.players[1])?0:1;a.rounds[b].winner=a.players[c],a.players[c].total+=1},e)}(g),g++,a.wait()},a.wait=function(){c(function(){a.nextRound()},f)}}]),angular.module("githubArenaApp").service("Github",["$http","$q",function(a,b){function c(a){var c=b.defer();return c.resolve({data:a}),c.promise}function d(b,d,f){var g=e[b][d];return g?c(g):a.get(f).success(function(a){e[b][d]=a,window.localStorage.setItem("cache",JSON.stringify(e))})}var e={repo:{},user:{}},f=window.localStorage.getItem("cache");f&&(e=JSON.parse(f));var g="https://api.github.com/users/";this.repo=function(a){return d("repo",a,g+a+"/repos")},this.user=function(a){return d("user",a,g+a)}}]);